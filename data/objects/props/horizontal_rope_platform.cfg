[object_type]
id=horizontal_rope_platform
platform_area=0,26,42,27

	[vars]
	rope_length=50
	move_speed=5
	[/vars]

	[properties]
	bottom_rope="get_object(level, vars.children[0])"
	top_rope="get_object(level, vars.children[1])"
	fixed_rope="get_object(level, vars.children[2])"
	left_wheel="get_object(level, vars.children[3])"
	right_wheel="get_object(level, vars.children[4])"
	[/properties]

	on_process="[
	   set(x, vars.xbase + xpos),
	   set(fixed_rope.x, vars.xbase + xpos + img_w/2 - 10),
	   bottom_rope.set_pos_len(-xpos/2, bottom_rope.vars.length),
	   top_rope.set_pos_len(xpos/2, top_rope.vars.length),
	   set(left_wheel.rotate, -xpos),
	   set(right_wheel.rotate, -xpos)

	   ]

	  where xpos = (wave(cycle*vars.move_speed)*((vars.move_x2 - vars.move_x1) - img_w))/2000
	"

	on_create="[
	    set(vars.xbase, ((vars.move_x2 - img_w) + vars.move_x1)/2),
	    spawn('horizontal_rope', vars.move_x1, y - vars.rope_length, 1, [set_var('length', vars.move_x2 - vars.move_x1)]),
	    spawn('horizontal_rope', vars.move_x1, y - (vars.rope_length + 14), 1, [set_var('length', vars.move_x2 - vars.move_x1)]),
	    spawn('vertical_rope', midpoint_x - 5, y - vars.rope_length, 1, [set_var('length', vars.rope_length + 4)]),
		spawn('wheel_rope', vars.move_x1, y - (vars.rope_length+8), 1, [set(zorder, zorder+1)]),
		spawn('wheel_rope', vars.move_x2, y - (vars.rope_length+8), 1, [set(zorder, zorder+1)]),
		]"
	on_child_spawned="set(vars.children, vars.children + [child.label])"

	[animation]
	image=props/rope.png
	id=normal
	x=18
	y=0
	w=42
	h=34
	[/animation]
[/object_type]
