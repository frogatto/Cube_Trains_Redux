[object_type]
	id=walker-1
	is_human=true

	[editor_info]
		category=player
	[/editor_info]
	
	[consts]
		rear_axle=[-30, 33]
		front_axle=[54, 33]
	[/consts]
	
	[vars]
		legs=[]
	[/vars]
	

	
	on_create="[
		debug(~init walker-1~),
		
		#Far rear leg.#
		spawn('walker-1.upper-leg', self.midpoint_x+consts.rear_axle[0], self.midpoint_y+consts.rear_axle[1], self.facing, [
			set(z, z-2),
			set_var('parent', self),
		]),
		#Near rear leg.#
		spawn('walker-1.upper-leg', self.midpoint_x+consts.rear_axle[0], self.midpoint_y+consts.rear_axle[1], self.facing, [
			set_var('parent', self),
		]),
		#Far front leg.#
		spawn('walker-1.upper-leg', self.midpoint_x+consts.front_axle[0], self.midpoint_y+consts.front_axle[1], self.facing, [
			set(z, z-2),
			set_var('parent', self),
		]),
		#Near front leg.#
		spawn('walker-1.upper-leg', self.midpoint_x+consts.front_axle[0], self.midpoint_y+consts.front_axle[1], self.facing, [
			set_var('parent', self),
		]),
	]"
	
	on_ctrl_attack="[
		debug(vars.legs),
	]"
	
	
	on_end_anim="animation('normal')"
	
	[animation]
		id=normal
		image=experimental/spiderbot.png
		rect=11,9,108,52
		pad=0
		frames=1
		duration=1000
		item_area=all
	[/animation]
	
	
	
	[object_type]
		id=upper-leg
		
		[vars]
			parent=null
		[/vars]
				
		on_spawned = "[
			set(parent_.vars.legs, parent_.vars.legs + [self]),
			debug(parent),
		] where parent_ = self.vars.parent"
		
		on_end_anim="animation('normal')"
		
		[animation]
			id=normal
			image=experimental/spiderbot.png
			rect=10,64,21,105
			pad=0
			frames=1
			duration=1000
			item_area=all
		[/animation]
	[/object_type]




	[particle_system]
		id=particles
		type=simple
		min_y=-10
		max_y=30
		min_x=-10
		max_x=30
		spawn_rate=10
		time_to_live=18
		[animation]
			id=sparkle
			image=props/items.png
			rect=139,88,149,98
			frames=4
			pad=3
			duration=6
		[/animation]
		
		[animation]  ##same thing, but skip the first frame
			id=sparkle
			image=props/items.png
			rect=153,88,163,98
			frames=3
			pad=3
			duration=4
		[/animation]
		
		[animation]  ##same thing, but skip the first 2 frames
			id=sparkle
			image=props/items.png
			rect=167,88,177,98
			frames=2
			pad=3
			duration=6
		[/animation]
	[/particle_system]


[/object_type]