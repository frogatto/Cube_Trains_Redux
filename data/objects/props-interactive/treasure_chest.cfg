	[object_type]
	id=treasure_chest
	zorder=-1

	[editor_info]
	category=props
	[/editor_info]
	
	[vars]
		loot=[]
	[/vars]

	on_create="animation('normal')"
	on_interact="[animation('opening'),sound('DoorOpen.ogg'),fire_event(level.player, 'start_interact')]"

	on_end_normal_anim="animation('normal')"
	on_end_opening_anim="[animation('open'),fire_event(level.player, 'end_interact'),fire_event('treasure_give'),schedule(50, fire_event('force_loot_acquire'))]"
	on_end_open_anim="animation('open')"


	###We must put this in a separate function, because loot only exists *after* the treasure_give event has fired.  If we called it above, it would have no target.
	on_force_loot_acquire="if(vars.loot.size > 0,fire_event(vars.loot[0],'acquired'))"
	on_child_spawned="set(vars.loot, vars.loot + [child])"


	### An example loot spawn
	#on_treasure_give="spawn('points_cube',midpoint_x,y-50,facing,[set(velocity_y,-1000),set(accel_y,40)])"

	solid_dimensions=npc
	solid_area=16,16,47,47
		[base:animation]
		image=props/interactive-props.png
		body_rect=all
		[/animation]

		[animation]
		id=normal
		rect=0,0,63,48
		duration=200
		interact_area=all
		[/animation]

		[animation]
		id=opening
		rect=0,0,63,48
		frames=6
		frames_per_row=3
		pad=0
		duration=5
		[/animation]
		
		[animation]
		id=open
		rect=128,49,191,97
		duration=200
		[/animation]
		
		
		
	[/object_type]
