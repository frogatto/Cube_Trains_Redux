	
	[object_type]
	id=mushroom_hopper_red
	prototype=hittable
	tags=swallowable

	[editor_info]
	category=plants
	[/editor_info]

	[properties]
		attack_damage=1
		team="'evil'"
	[/properties]
	
	[vars]
		points_value="10"
		rebound=0
	[/vars]

	[consts]
		solid_dimensions="['common','enemy']"
		basic_type="'mushroom_hopper_red'"
		basic_animation="'stand'"
		thrown_type="'mushroom_hopper_red.thrown'"
		frogourmet_tag="'mushroom_hopper_red'"
	[/consts]
	
	friction=1000
	traction=1000
	traction_in_air=0
	
	springiness=100
	
	on_land="[if(velocity_y>300,set(vars.rebound, -(velocity_y*2)/3)),animation('land')]"
	

	on_collide_feet="fire_event(me, 'land')"

	on_end_stand_anim="[if(1d3=3,animation('inflate'),animation('hop'))]"
	on_end_inflate_anim="[spawn('mushroom_hopper_red.cap',midpoint_x,y-10,facing,[set(velocity_y,-1000)]),animation('headless')]"
	on_end_headless_anim="animation('regrow')"
	on_end_regrow_anim="animation('stand')"
	
	on_end_hop_anim="[animation('fall'),set(velocity_y,-800-1d400),set(velocity_x, (200+1d100)* if(level.player.midpoint_x<midpoint_x,-1,1))]"
	on_end_fall_anim="if(is_standing, fire_event(me, 'land'), animation('fall'))"

	#give it a little bounce, if it's falling fast
	on_end_land_anim="if(vars.rebound,[animation('fall'),set(velocity_y,vars.rebound), set(vars.rebound,0)],animation('stand'))"

	
	solid_area=8,11,15,21
	solid_dimensions=enemy,common
		[base:animation]
		image=enemies/mushroom-hopper-red.png
		pad=3
		accel_x=0
		accel_y=60
		body_area=all
		attack_area=5,5,17,10
		[/animation]

		[animation]
		id=hop
		rect=27,1,49,23
		frames=1
		duration=5
		[/animation]

		[animation]
		id=land
		rect=27,1,49,23
		frames=1
		duration=5
		[/animation]

		[animation]
		id=fall
		rect=53,1,75,23
		frames=1
		duration=10
		[/animation]


		[animation]
		id=stand
		rect=1,1,23,23
		frames=1
		duration=40
		[/animation]
	
		[animation]
		id=inflate
		rect=1,27,23,49
		frames=2
		duration=5
		[/animation]

		[animation]
		id=inflate
		rect=1,27,23,49
		frames=2
		duration=5
		[/animation]
		
		[animation]
		id=headless
		rect=53,27,75,49
		frames=5
		duration=5
		[/animation]

		[animation]
		id=regrow
		rect=1,53,23,75
		frames=2
		duration=5
		[/animation]


		[object_type]	
		id=thrown
		prototype=throwable_small_enemy
		solid_area=8,11,15,21

		[consts]
			basic_type="'mushroom_hopper_red'"
			thrown_type="'mushroom_hopper_red.thrown'"
			frogourmet_tag="'mushroom_hopper_red'"
		[/consts]

			[base:animation]
			image=enemies/mushroom-hopper-red.png
			pad=3
			accel_x=0
			accel_y=60
			[/animation]

			[animation]
			id=thrown
			thrown_area=all
			duration=60
			rect=131,1,153,23
			frames=1
			body_area=none
			[/animation]
			
			[animation]
			id=on_back
			rect=105,1,127,23
			frames=3
			duration=3
			body_area=all
			[/animation]
		[/object_type]
	
		[object_type]
			id=cap
			always_active=yes
			affected_by_currents=yes
			object_level_collisions=yes
			prototype=shot

			zorder=10

			on_die="spawn('explosion_big_dusty',midpoint_x,midpoint_y,facing)"
			on_end_anim="[animation('normal'),if(velocity_y > 50,die())]"
			
			[animation]
			id=normal
			image=enemies/mushroom-hopper-red.png
			rect=186,4,202,20
			frames=4
			frames_per_row=2
			duration=4
			pad=3
			accel_y=20
			attack_area=all
			[/animation]
			
			
		[/object_type]
	
	[/object_type]

