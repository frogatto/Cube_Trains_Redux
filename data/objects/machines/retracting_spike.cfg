[object_type]
id=retracting_spike
on_create="[set_var('state', 'retracted'), set_var('y_extended', y + 60*up), set_var('y_retracted', y)]"
on_process="[set_var('count', count + 1),
    switch(state,
	       'retracted', if(count >= retracted_ticks, [set_var('count', 0), set_var('state', 'stab')]),
	       'stab', if(count >= stab_ticks, [set_var('count', 0), set_var('state', 'extended'), set('y', y_extended)],
	                                       set('y', transition(count, 0, y_retracted, stab_ticks, y_extended))),
	       'extended', if(count >= extended_ticks, [set_var('count', 0), set_var('state', 'retract')]),
	       'retract', if(count >= retract_ticks, [set_var('count', 0), set_var('state', 'retracted'), set('y', y_retracted)],
	                                       set('y', transition(count, 0, y_extended, retract_ticks, y_retracted))))]"
	[animation]
	id=normal
	image=props/retractingspike1.png
	rect=24,9,37,41
	collide_x=5
	collide_y=0
	collide_w=3
	collide_h=32
	frames=1
	duration=1000000
	[/animation]

[/object_type]
