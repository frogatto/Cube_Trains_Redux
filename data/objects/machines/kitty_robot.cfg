[object_type]
id=kitty_robot
friction=1
on_create="[set('hitpoints', 3), set('xp_level', 1), set('experience', 0), set('shoot_missile', 0),
            if(0,spawn('kitty_sword', x, y, face_right, [board_vehicle(me)]))]"
#on_hit_by_player="[set('green', 0), set('blue', 0)]"
on_driver_hit_by_player="[eject_vehicle()]"
on_get_hit="[set('invincible', 150), set('hitpoints', hitpoints - 1), if(hitpoints <= 1, eject_vehicle())]"
on_process="
 if(is_human,
 [
    if(ctrl_attack and animation != 'turn',
if(loaded >= (50 - xp_level*12), [spawn('robot_missile' + xp_level, x + 25*facing, y+10, facing), set('shoot_missile', cycle)], null()) where loaded = cycle - shoot_missile, xp_level = 1 + (experience/7)
			),
		if(ctrl_right and animation != 'turn' and is_standing, if(facing < 0, [animation('turn'), set('facing', 1)], if(animation = 'normal' and is_standing, animation('walk')))),
		if(ctrl_left and animation != 'turn' and is_standing, if(facing > 0, [animation('turn'), set('facing', -1)], if(animation = 'normal' and is_standing, animation('walk')))),
		if((ctrl_left or ctrl_right) and (not is_standing), [set('accel_x', if(ctrl_left and facing < 0 or ctrl_right and facing > 0, 10, -10))]),
		if(ctrl_jump and (animation = 'walk' or animation = 'normal'),
				animation('prepare_jump')),
		if((not is_standing) and animation != 'jump' and animation != 'normal' and animation != 'turn', animation('normal'))
	]
		 )"
on_end_anim="switch(animation,
                    'turn', animation('normal'),
                    'prepare_jump', animation('jump'),
					'walk', animation('normal'),
					'jump', animation('normal'),
					animation(animation))"
on_bounce="[debug('bounce ', bounce_off.destroyed), if(bounce_off and (not bounce_off.destroyed), set('velocity_y', (-velocity_y*bounce_off.springiness)/100))]"
body_harmful=no
passenger_x=20
passenger_y=-40
vehicle=true
springiness=100
feet_width=5
mass=2000
	[animation]
	id=normal
		image=robot.png
		collide_x=14
		collide_y=0
		collide_w=30
		collide_h=30
		rect=0,42,47,82
		feet_x=29
		feet_y=40
		accel_x=0
		accel_y=10
		frames=1
		duration=6
		scale=2
	[/animation]
		[animation]
		id=turn
		image=robot.png
		collide_x=14
		collide_y=0
		collide_w=30
		collide_h=30
		rect=49,42,96,82
		feet_x=29
		feet_y=40
		accel_y=10
		frames=3
		duration=6
		scale=2
		pad=1
		[/animation]

		[animation]
		id=walk
		image=robot.png
		collide_x=14
		collide_y=0
		collide_w=30
		collide_h=30
		rect=0,91,47,131
		feet_x=29
		feet_y=40
		accel_x=100
		accel_y=10
		frames=2
		duration=6
		scale=2
		[/animation]

		[animation]
		id=prepare_jump
		image=robot.png
		collide_x=14
		collide_y=0
		collide_w=30
		collide_h=30
		rect=0,138,47,178
		feet_x=29
		feet_y=40
		accel_y=10
		frames=3
		duration=10
		scale=2
		[/animation]

		[animation]
		id=jump
		image=robot.png
		collide_x=14
		collide_y=0
		collide_w=30
		collide_h=30
		rect=150,125,197,175
		feet_x=29
		feet_y=40
		velocity_y=-700
		frames=1
		duration=20
		scale=2
		[/animation]

[/object_type]
