
	[object_type]
	id=airplane-boss
	always_active=yes
	hitpoints=7
	mass=5
	body_passthrough=yes
	vehicle=true
	body_harmful=no
	ignore_collide=yes
	traction_in_air=1000

	[vars]
	left_bound=-300
	right_bound=1000
	left_bound_missile=-100
	right_bound_missile=900
	heights="[70, 210, 270] * 100"
	heights_index="0"
	[/vars]

	on_hit_by_player="[if(hitpoints > hit_by.damage, [set('invincible', 50), set('hitpoints', hitpoints - hit_by.damage)], set('hitpoints', 1))]"
	on_create="[animation('fly'), spawn('kitty_sword', x, y, face_right, [board_vehicle(me)])]"
	on_end_anim="animation('fly')"
	on_die="[debug('airplane die'), set(level, 'boss_killed', 1)]"

	on_process="[if(hitpoints = 1,
	             spawn('smoke_particle',  x + 1d(w), y + 40 + 1d(h), -facing)),
	
	[set('blue', col), set('green', col), set(driver, 'blue', col), set(driver, 'green', col)] where col = if((invincible/5)%2 = 0, 255, 0), 
	               if(facing < 0 and x < left_bound or facing > 0 and x > right_bound,
	               [set('strafing', -1), facing(-facing), animation('fly'), set('velocity_x', 0), set('y', heights[heights_index]), set('heights_index', heights_index+1), if(hitpoints = 1, die())])]"

	timer_frequency="15"
	on_timer="[
	     if(hitpoints > 1 and x > left_bound_missile and x2 < right_bound_missile,
	          if(strafing > 0, [set('strafing', strafing - 1),
                spawn('airplane-missile', midpoint_x, midpoint_y+40, facing, [set('velocity_x', velocity_x)])],
				if(strafing = -1 and (level.player.midpoint_x - midpoint_x)*facing < (200 + (level.player.y - y)), set('strafing', 8))))
				]"
	passenger_x=20
	passenger_y=12
	zorder=-10
	
#	solid_area=12,23,55,60
		[animation]
		id=stand
		image=vehicles/plane.png
		rect=11,2,79,70
		frames=1
		pad=3
		duration=100000
		[/animation]
		
		[animation]
		id=fly
		image=vehicles/plane.png
		rect=94,2,162,70
		frames=4
		pad=3
		duration=1
		accel_x=8
		[/animation]

	[/object_type]
