	
	[object_type]
	id=mushroom_hopper_red
	prototype=hittable,throwable

	[editor_info]
	category=plants
	[/editor_info]
	
	[vars]
		points_value="10"
		turns_at_cliffs=1
		team="'evil'"
		rebound=0
	[/vars]

	[consts]
		solid_dimensions="['enemy']"
	[/consts]
	
	friction=1000
	traction=1000
	traction_in_air=0
	
	springiness=100
	
	on_land="[debug(velocity_y),if(velocity_y>300,set(vars.rebound, -(velocity_y*2)/3)),animation('land')]"
	

	on_collide_feet="fire_event(me, 'land')"

	on_end_stand_anim="[if(1d3=3,animation('inflate'),animation('hop'))]"
	on_end_inflate_anim="[spawn('mushroom_hopper_red.cap',midpoint_x,y-10,facing,[set(velocity_y,-1000)]),animation('headless')]"
	on_end_headless_anim="animation('regrow')"
	on_end_regrow_anim="animation('stand')"
	
	on_end_hop_anim="[animation('fall'),set(velocity_y,-800-1d400),set(velocity_x, (200+1d100)* if(level.player.midpoint_x<midpoint_x,-1,1))]"
	on_end_fall_anim="if(is_standing, fire_event(me, 'land'), animation('fall'))"

	#give it a little bounce, if it's falling fast
	on_end_land_anim="if(vars.rebound,[animation('fall'),set(velocity_y,vars.rebound), set(vars.rebound,0)],animation('stand'))"

	on_collide_object_thrown="
	[if(collide_with_area = 'body' and collide_with.vars.team != vars.team and vars.damage > 0,
		 [if(collide_with.get_hit_by, [spawn('impact_cloud',midpoint_x,y,facing) ,collide_with.get_hit_by(me)]), die()])]"
	on_leave_thrown_anim="[set(solid_dimensions_in, consts.solid_dimensions), set(vars.team, 'evil'), set(vars.damage, consts.normal_damage)]"

	
	solid_area=8,11,15,21
	solid_dimensions=enemy
		[base:animation]
		image=enemies/mushroom-hopper-red.png
		pad=3
		accel_x=0
		accel_y=60
		body_area=all
		[/animation]

		[animation]
		id=thrown
		thrown_area=0,0,31,36
		duration=60
		rect=131,1,153,23
		frames=1
		body_area=none
		[/animation]
		
		[animation]
		id=on_back
		rect=105,1,127,23
		frames=3
		duration=4
		[/animation]

		[animation]
		id=hop
		rect=27,1,49,23
		frames=1
		duration=5
		[/animation]

		[animation]
		id=land
		rect=27,1,49,23
		frames=1
		duration=5
		[/animation]

		[animation]
		id=fall
		rect=53,1,75,23
		frames=1
		duration=10
		[/animation]


		[animation]
		id=stand
		rect=1,1,23,23
		frames=1
		duration=40
		[/animation]
	
		[animation]
		id=inflate
		rect=1,27,23,49
		frames=2
		duration=5
		[/animation]

		[animation]
		id=inflate
		rect=1,27,23,49
		frames=2
		duration=5
		[/animation]
		
		[animation]
		id=headless
		rect=53,27,75,49
		frames=5
		duration=5
		[/animation]

		[animation]
		id=regrow
		rect=1,53,23,75
		frames=2
		duration=5
		[/animation]
	
		[object_type]
			id=cap
			[vars]
				team="'evil'"
				damage=1
			[/vars]
			always_active=yes
			affected_by_currents=yes
			object_level_collisions=yes
			prototype=shot

			zorder=10

			
			[animation]
			id=normal
			image=enemies/mushroom-hopper-red.png
			rect=186,4,202,14
			frames=1
			accel_y=20
			attack_area=all
			[/animation]
			
			
		[/object_type]
	
	[/object_type]

