[gui]
on_process="if (object.vars.scheme_loaded != level.player.control_scheme,
			[
			set(object.vars.buttons,
				map(control_scheme_node.elements.button, 'button',
					{'id' -> button.id, 'x' -> eval(button.x), 'y' -> eval(button.y), 'anim' -> button.anim, 'anim_down' -> button.anim_down})
				where control_scheme_node = find(get_document('data/control_schemes.cfg').elements.control_scheme, id = level.player.control_scheme)),
			set(object.vars.scheme_loaded, level.player.control_scheme)
			])"
on_draw="if(IPHONE_SYSTEM,
			if((not level.player.underwater_controls),
				[
				map(['up', 'down', 'left', 'right'], 'i',
					if(query(level.player, 'ctrl_'+i),
					[color(255, 255, 255, 255), draw_animation(b.anim_down, b.x, b.y)],
					[color(255, 255, 255, 128), draw_animation(b.anim, b.x, b.y)])
					where b = find(object.vars.buttons, 'button', button['id'] = i)
				),

			    [
					if(level.player.ctrl_tongue, color(255, 255, 255, 255), color(255, 255, 255, 128)),
					draw_animation(a.anim, if(level.player.ctrl_reverse_ab, b, a).x, if(level.player.ctrl_reverse_ab, b, a).y),

					if(level.player.ctrl_jump, color(255, 255, 255, 255), color(255, 255, 255, 128)),
					draw_animation(b.anim, if(level.player.ctrl_reverse_ab, a, b).x, if(level.player.ctrl_reverse_ab, a, b).y)
				]
				where b = find(object.vars.buttons, 'button', button['id'] = 'b')
				where a = find(object.vars.buttons, 'button', button['id'] = 'a'),

				color(255, 255, 255, 255),

				if(level.player.can_interact, draw_animation(b.anim, b.x, b.y)
					where b = find(object.vars.buttons, 'button', button['id'] = 'interact'))
				],

				#controls when underwater#
				[
					[
						if(level.player.ctrl_tongue, color(255, 255, 255, 255), color(255, 255, 255, 128)),
						draw_animation(a.anim, if(level.player.ctrl_reverse_ab, b, a).x, if(level.player.ctrl_reverse_ab, b, a).y),
					]
					where b = find(object.vars.buttons, 'button', button['id'] = 'b')
					where a = find(object.vars.buttons, 'button', button['id'] = 'a'),
					color(255, 255, 255, 255)
				]
			))"
	[animation]
	id="iphone_b"
	duration="1"
	frame_info="0,0,1,1,794,384,50,58"
	frames="1"
	image="compiled-1.png"
	rect="794,384,844,442"
	scale="2"
	[/animation]

	[animation]
	id="iphone_a"
	duration="1"
	frame_info="0,0,1,1,744,384,50,58"
	frames="1"
	image="compiled-1.png"
	rect="744,384,794,442"
	scale="2"
	[/animation]

	[animation]
	id="iphone_b_down"
	duration="1"
	frame_info="0,0,1,1,694,384,50,58"
	frames="1"
	image="compiled-1.png"
	rect="694,384,744,442"
	scale="3"
	[/animation]

	[animation]
	id="iphone_a_down"
	duration="1"
	frame_info="0,0,1,1,644,384,50,58"
	frames="1"
	image="compiled-1.png"
	rect="644,384,694,442"
	scale="3"
	[/animation]

	[animation]
	id="iphone_action"
	duration="1"
	frame_info="0,0,1,1,963,248,50,58"
	frames="1"
	image="compiled-0.png"
	rect="963,248,1013,306"
	scale="2"
	[/animation]

	[animation]
	id="iphone_action_down"
	duration="1"
	frame_info="0,0,1,1,963,190,50,58"
	frames="1"
	image="compiled-0.png"
	rect="963,190,1013,248"
	scale="2"
	[/animation]

	[animation]
	id="iphone_up"
	duration="1"
	frame_info="0,2,1,0,804,444,46,53"
	frames="1"
	image="compiled-1.png"
	rect="804,442,850,496"
	scale="2"
	[/animation]

	[animation]
	id="iphone_up_pressed"
	duration="1"
	frame_info="0,2,1,0,850,444,46,53"
	frames="1"
	image="compiled-1.png"
	rect="850,442,896,496"
	scale="2"
	[/animation]

	[animation]
	id="iphone_down"
	duration="1"
	frame_info="0,1,1,2,978,280,46,28"
	frames="1"
	image="compiled-2.png"
	rect="978,279,1024,309"
	scale="2"
	[/animation]

	[animation]
	id="iphone_down_pressed"
	duration="1"
	frame_info="0,1,1,2,776,336,46,28"
	frames="1"
	image="compiled-2.png"
	rect="776,335,822,365"
	scale="2"
	[/animation]

	[animation]
	id="iphone_left"
	duration="1"
	frame_info="1,0,2,1,926,599,72,46"
	frames="1"
	image="compiled-1.png"
	rect="925,599,999,645"
	scale="2"
	[/animation]

	[animation]
	id="iphone_left_pressed"
	duration="1"
	frame_info="1,0,2,1,507,809,72,46"
	frames="1"
	image="compiled-0.png"
	rect="506,809,580,855"
	scale="2"
	[/animation]

	[animation]
	id="iphone_right"
	duration="1"
	frame_info="3,0,0,0,888,809,72,45"
	frames="1"
	image="compiled-0.png"
	rect="885,809,959,853"
	scale="2"
	[/animation]

	[animation]
	id="iphone_right_pressed"
	duration="1"
	frame_info="3,0,0,0,657,809,72,45"
	frames="1"
	image="compiled-0.png"
	rect="654,809,728,853"
	scale="2"
	[/animation]

	[animation]
	id="ipad_b"
	duration="1"
	frame_info="0,0,1,1,794,384,50,58"
	frames="1"
	image="compiled-1.png"
	rect="794,384,844,442"
	scale="1"
	[/animation]

	[animation]
	id="ipad_a"
	duration="1"
	frame_info="0,0,1,1,744,384,50,58"
	frames="1"
	image="compiled-1.png"
	rect="744,384,794,442"
	scale="1"
	[/animation]

	[animation]
	id="ipad_b_down"
	duration="1"
	frame_info="0,0,1,1,694,384,50,58"
	frames="1"
	image="compiled-1.png"
	rect="694,384,744,442"
	scale="1"
	[/animation]

	[animation]
	id="ipad_a_down"
	duration="1"
	frame_info="0,0,1,1,644,384,50,58"
	frames="1"
	image="compiled-1.png"
	rect="644,384,694,442"
	scale="1"
	[/animation]

	[animation]
	id="ipad_action"
	duration="1"
	frame_info="0,0,1,1,963,248,50,58"
	frames="1"
	image="compiled-0.png"
	rect="963,248,1013,306"
	scale="1"
	[/animation]

	[animation]
	id="ipad_action_down"
	duration="1"
	frame_info="0,0,1,1,963,190,50,58"
	frames="1"
	image="compiled-0.png"
	rect="963,190,1013,248"
	scale="1"
	[/animation]

	[animation]
	id="ipad_up"
	duration="1"
	frame_info="0,2,1,0,804,444,46,53"
	frames="1"
	image="compiled-1.png"
	rect="804,442,850,496"
	scale="1"
	[/animation]

	[animation]
	id="ipad_up_pressed"
	duration="1"
	frame_info="0,2,1,0,850,444,46,53"
	frames="1"
	image="compiled-1.png"
	rect="850,442,896,496"
	scale="1"
	[/animation]

	[animation]
	id="ipad_down"
	duration="1"
	frame_info="0,1,1,2,978,280,46,28"
	frames="1"
	image="compiled-2.png"
	rect="978,279,1024,309"
	scale="1"
	[/animation]

	[animation]
	id="ipad_down_pressed"
	duration="1"
	frame_info="0,1,1,2,776,336,46,28"
	frames="1"
	image="compiled-2.png"
	rect="776,335,822,365"
	scale="1"
	[/animation]

	[animation]
	id="ipad_left"
	duration="1"
	frame_info="1,0,2,1,926,599,72,46"
	frames="1"
	image="compiled-1.png"
	rect="925,599,999,645"
	scale="1"
	[/animation]

	[animation]
	id="ipad_left_pressed"
	duration="1"
	frame_info="1,0,2,1,507,809,72,46"
	frames="1"
	image="compiled-0.png"
	rect="506,809,580,855"
	scale="1s"
	[/animation]

	[animation]
	id="ipad_right"
	duration="1"
	frame_info="3,0,0,0,888,809,72,45"
	frames="1"
	image="compiled-0.png"
	rect="885,809,959,853"
	scale="1"
	[/animation]

	[animation]
	id="ipad_right_pressed"
	duration="1"
	frame_info="3,0,0,0,657,809,72,45"
	frames="1"
	image="compiled-0.png"
	rect="654,809,728,853"
	scale="1"
	[/animation]

[/gui]

