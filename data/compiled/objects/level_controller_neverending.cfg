[object_type]
always_active="yes"
id="level_controller_neverending"
next_animation="'normal'"
on_create="if(level.in_editor, die(),
	            [set(alpha, 0),
				set(level.dimensions, [level.dimensions[0], level.dimensions[1], level.dimensions[0] + 10000000, level.dimensions[3]]),
	            add_level_module('0', 0, 0),
	            set(vars.left_edge, 0), set(vars.right_edge, level.segment_width)])"
on_process="if(level.player.midpoint_x > vars.cosmic_shift_threshhold, [cosmic_shift(-vars.cosmic_shift_amount, 0),
				  add(vars.left_edge, -vars.cosmic_shift_amount), add(vars.right_edge, -vars.cosmic_shift_amount)],
	            [
	            set(level.dimensions, [max(level.dimensions[0], level.player.midpoint_x-400), level.dimensions[1], level.dimensions[2], level.dimensions[3]]),
	            if(level.player.midpoint_x > vars.right_edge - 600,
	               [
	               add(vars.segments, [new_segment]),
				   add_level_module(new_segment, vars.right_edge, 0),
				   add(vars.right_edge, level.segment_width)
				   ]
				   where new_segment = choose(filter(query(level, 'segments_after_' + vars.segments.last), 'n', not (n in vars.segments)))
				   ),
				 if(level.player.midpoint_x > vars.left_edge + 500 + level.segment_width,
				   [remove_level_module(vars.segments[0]),
				    add(vars.left_edge, level.segment_width),
					set(vars.segments, filter(vars.segments, 'n', n != vars.segments[0]))])
	            ])"
respawns="no"
zorder="50"
	[vars]
	cosmic_shift_amount="15360"
	cosmic_shift_threshhold="16384"
	left_edge="0"
	right_edge="0"
	segments="[0]"
	[/vars]

	[animation]
	duration="1000000"
	frame_info="0,1,2,1,708,230,26,26"
	frames="1"
	id="normal"
	image="compiled-2.png"
	rect="708,229,735,256"
	[/animation]

[/object_type]

