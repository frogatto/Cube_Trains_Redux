[object_type]
id="bat"
on_become_active="if(vars.bat, if(vars.bat.hitpoints <= 0, die(), fire_event(vars.bat, 'restore')))"
on_child_spawned="[
	  set(child.vars.zone_x1, vars.zone_x1),
	  set(child.vars.zone_x2, vars.zone_x2),
	  set(child.vars.zone_y1, vars.zone_y1),
	  set(child.vars.zone_y2, vars.zone_y2),
	  set(vars.bat, child)
	 ]"
on_create="[set(alpha, 0), spawn('bat.instance', midpoint_x, midpoint_y, facing)]"
	[vars]
	bat="null()"
	damage="1"
	team="'evil'"
	[/vars]

	[animation]
	duration="1000000"
	frame_info="1,1,1,3,1008,145,16,24"
	frames="1"
	id="hang"
	image="compiled-2.png"
	rect="1007,144,1024,171"
	[/animation]

	[object_type]
	hitpoints="1"
	id="instance"
	on_collide_object_thrown="[if(collide_with_area = 'body' and collide_with.vars.team != vars.team,
		 [if(collide_with.get_hit_by, [collide_with.get_hit_by(me)]), die()])]"
	on_create="[set(vars.start_x, x), set(vars.start_y, y)]"
	on_die="[score(level, 10), spawn_item(self), spawn('die_cloud', midpoint_x, midpoint_y, facing)]"
	on_end_alert_anim="[set(velocity_y, 200), set(accel_y, -2), animation('fly')]"
	on_end_fly_anim="animation('fly')"
	on_end_hang_anim="if(level.player.midpoint_x > vars.zone_x1 and level.player.midpoint_x < vars.zone_x2 and level.player.midpoint_y > vars.zone_y1 and level.player.midpoint_y < vars.zone_y2, [set(animation, 'alert'), set(vars.flying, 1)], set(animation, 'hang'))"
	on_end_hurt_anim="[set(velocity_y, 200), set(accel_y, -2), animation('fly')]"
	on_enter_thrown_anim="[set(vars.damage, consts.thrown_damage)]"
	on_leave_thrown_anim="[set(vars.damage, consts.normal_damage)]"
	on_restore="if(animation = 'thrown', set(hitpoints, 0), [if(vars.flying and (not active), [set(vars.flying, 0), animation('hang'), set(x, vars.start_x), set(y, vars.start_y)])])"
	prototype="hittable"
	tags="swallowable"
	traction_in_air="1000"
	zorder="20"
		[vars]
		damage="1"
		flying="0"
		start_x="0"
		start_y="0"
		team="'evil'"
		zone_x1="0"
		zone_x2="0"
		zone_y1="0"
		zone_y2="0"
		[/vars]

		[consts]
		normal_damage="1"
		thrown_damage="5"
		[/consts]

		[animation]
		accel_x="0"
		accel_y="0"
		body_area="all"
		duration="10"
		frames="2"
		frames_per_row="2"
		id="hang"
		image="enemies/bat.png"
		pad="3"
		rect="1,1,18,28"
		velocity_x="0"
		velocity_y="0"
		[/animation]

		[animation]
		body_area="all"
		duration="20"
		frames="1"
		frames_per_row="1"
		id="alert"
		image="enemies/bat.png"
		pad="0"
		rect="43,1,60,28"
		[/animation]

		[animation]
		accel_x="-10"
		attack_area="all"
		body_area="all"
		duration="8"
		frames="4"
		frames_per_row="4"
		id="fly"
		image="enemies/bat.png"
		pad="3"
		rect="1,32,26,70"
		reverse="no"
		[/animation]

		[animation]
		body_area="all"
		duration="10"
		frames="1"
		frames_per_row="1"
		id="hurt"
		image="enemies/bat.png"
		pad="0"
		rect="120,32,145,70"
		[/animation]

		[animation]
		accel_y="70"
		body_area="none"
		duration="30"
		frames="1"
		frames_per_row="1"
		id="thrown"
		image="enemies/bat.png"
		pad="0"
		rect="120,32,145,70"
		thrown_area="all"
		[/animation]

	[/object_type]

[/object_type]

