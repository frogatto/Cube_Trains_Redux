[object_type]
always_active="yes"
id="curvey_rope_controller_swaying"
next_animation="'normal'"
on_create="if(level_points, [set(alpha, 0), 
		[map(segments, 'seg', add_object(seg)),
		set(vars.segments, segments),
		fire_event('set_segments'),
		]
			where segments = map(range(0,resolution), 'point', object('rope_angled_controller', bcurve(level_points, ind)[0], bcurve(level_points, ind)[1], 0, {'index' -> ind})
				where ind = point * (100.0/resolution) 
			)]
			)
		where resolution = vars.resolution"
on_end_anim="animation('normal')"
on_set_segments="map(vars.segments, 'segment', [
			segment.set_ends(
				bcurve(level_points, segment.vars.index+0/resolution)[0], 
				bcurve(level_points, segment.vars.index+0/resolution)[1], 
				bcurve(level_points, segment.vars.index+100.0/resolution+1)[0], 
				bcurve(level_points, segment.vars.index+100.0/resolution+1)[1]
			),
		]) where resolution = vars.resolution"
on_timer="if(level_points, [
			map(lpof[1:size(lpof)-1], 'lp', set(lp.x, lp.x+delta)) where delta = sin((cycle+vars.center)*vars.frequency)/vars.sway where lpof=level_points_objs_from(0),
			fire_event('set_segments'),
		])"
timer_frequency="3"
zorder="100"
	[properties]
	bcurve="def(points, percent) 
		if(size(points)=2, 
			[(points[0][0]*(100-percent) + points[1][0]*percent)/100.0, 
			(points[0][1]*(100-percent) + points[1][1]*percent)/100.0], 
			bcurve(map(range(size(points)-1), 'ind', bcurve(points[ind:ind+2], percent)), percent)
			)"
	level_points="level_points_from(0)"
	level_points_from="def(pnum) if(next_label, [[next_label.midpoint_x, next_label.midpoint_y]] + level_points_from(pnum+1)) where next_label = get_object(level, self.label + ' ' + str(pnum))"
	level_points_objs_from="def(pnum) if(next_label, [next_label] + level_points_objs_from(pnum+1)) where next_label = get_object(level, self.label + ' ' + str(pnum))"
	[/properties]

	[animation]
	collide="0,0,28,28"
	duration="1000"
	frame_info="2,2,2,1,119,603,24,25"
	frames="1"
	id="normal"
	image="compiled-2.png"
	rect="117,601,144,628"
	[/animation]

[/object_type]

