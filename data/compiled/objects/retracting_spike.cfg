[object_type]
id="retracting_spike"
on_create="[set(vars.y_extended, y + 60*up), set(vars.y_retracted, y)]"
on_done_create="[
set(tmp.command_schedule,	[schedule(vars.retracted_ticks, [set(vars.damage, 1), set(velocity_y, (100*(vars.y_extended - vars.y_retracted))/vars.stab_ticks)]),
	                   schedule(vars.retracted_ticks + vars.stab_ticks, [set(y, vars.y_extended), set(velocity_y, 0)]),
					   schedule(vars.retracted_ticks + vars.stab_ticks + vars.extended_ticks, [set(vars.damage, 0), set(velocity_y, (100*(vars.y_retracted - vars.y_extended))/vars.retract_ticks)]),
					   schedule(vars.retracted_ticks + vars.stab_ticks + vars.extended_ticks + vars.retract_ticks,
					                           [set(y, vars.y_retracted), set(velocity_y, 0), fire_event('start_cycle')])
	]),
	schedule(vars.initial_delay, fire_event('start_cycle'))
]"
on_start_cycle="tmp.command_schedule"
	[vars]
	damage="0"
	extended_ticks="0"
	initial_delay="0"
	retract_ticks="0"
	retracted_ticks="0"
	stab_ticks="0"
	y_extended="0"
	y_retracted="0"
	[/vars]

	[tmp]
	command_schedule="null()"
	[/tmp]

	[animation]
	attack_area="all"
	duration="1000000"
	frame_info="0,0,1,1,1009,528,13,32"
	frames="1"
	id="normal"
	image="compiled-1.png"
	rect="1009,528,1022,560"
	[/animation]

[/object_type]

