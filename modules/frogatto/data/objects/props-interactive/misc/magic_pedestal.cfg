{
id: "magic_pedestal",
teleport_offset_x: 32,
teleport_offset_y: -200,
on_jumped_on: "if(cycle > 20,[if(animation != 'glow', [sound('teleporter-warmup.wav'),animation('glow')]), set(last_stood_on, cycle)])",
on_end_glow_anim: "[animation('cooldown'),
		if(size(activators) >= 1,
			if(level.player in activators,	fire_event(me,'transported'), achievement('scotty')) ) where activators = filter(level.chars, 'v', v.standing_on = me)]",
on_transported: "[spawn_player('map-selector', 0, 0, 1, [set(child.vars.player, level.player),set(child.vars.came_from_level,level.id)]), teleport('main-map.cfg','','instant'),sound('teleport.wav'),
	screen_flash([255,255,255,255], [0,0,0,-5], 50)
	]",
on_end_cooldown_anim: "animation('normal')",
on_create: "[add_particles('magic_sparkles'),add_particles('magic_sparkles2'),spawn('magic_pedestal.glow_mask',img_mid_x,img_mid_y,facing)]",
on_child_spawned: "set(glow, child)",
on_process_glow: "if(size(filter(level.chars, 'v', v.standing_on = me)) >= 1,
	       [
		   if(time_in_animation = 100, screen_flash([255,255,255,0], [0,0,0,5], 50)),
		   
		   set(vars.glow.alpha, (150*time_in_animation)/150), set(vars.glow.brightness, (500*time_in_animation)/150), set(magic_sparkles.generation_rate, (2000*time_in_animation)/150), set(magic_sparkles2.generation_rate, (2000*time_in_animation)/150)])",
on_process_cooldown: "[set(vars.glow.alpha, (150*(75-time_in_animation))/75), set(vars.glow.brightness, (800*(75-time_in_animation))/75), set(magic_sparkles.generation_rate, (2000*(75-time_in_animation))/75), set(magic_sparkles2.generation_rate, (2000*(75-time_in_animation))/75)]",
on_enter_normal_anim: "[set(magic_sparkles.generation_rate, 0 ), set(magic_sparkles2.generation_rate, 0 )]",
solid_area: [16,8,48,31],
solid_shape: "rect",
editor_info: {
	category: "props",
},
animation: [
	{
		image: "props/interactive-props.png",
		body_rect: "all",
		id: "normal",
		rect: [0,219,63,255],
		duration: 200,
	},
	{
		image: "props/interactive-props.png",
		body_rect: "all",
		id: "glow",
		rect: [64,219,127,255],
		frames: 3,
		pad: 0,
		duration: 50,
	},
	{
		image: "props/interactive-props.png",
		body_rect: "all",
		id: "cooldown",
		rect: [64,219,127,255],
		frames: 3,
		pad: 0,
		play_backwards: true,
		duration: 25,
	},
],
particle_system: [
	{
		id: "magic_sparkles",
		type: "point",
		generation_rate_millis: 0,
		time_to_live: 12,
		time_to_live_rand: 64,

		#colors="ff81f8ff"
		red: 128,
		green: 255,
		blue: 248,
		alpha: 1,
		alpha_delta: -100,
		alpha_rand: 100,
		dot_size: 1,
		pos_x: 34,
		pos_x_rand: 60,
		pos_y: 16,
		velocity_x: -50,
		velocity_x_rand: 100,
		velocity_y: -1000,
		velocity_y_rand: 1500,
	},
	{
		id: "magic_sparkles2",
		type: "point",
		generation_rate_millis: 0,
		time_to_live: 12,
		time_to_live_rand: 64,

		#colors="ff81f8ff"
		red: 128,
		green: 255,
		blue: 48,
		blue_rand: 200,
		alpha: 1,
		alpha_delta: -100,
		alpha_rand: 100,
		dot_size: 1,
		pos_x: 54,
		pos_x_rand: 20,
		pos_y: 16,
		velocity_x: -100,
		velocity_x_rand: 200,
		velocity_y: -2500,
		velocity_y_rand: 3000,
	},
],
object_type: {
	id: "glow_mask",
	zorder: 2,
	on_create: "set(alpha,0)",
	animation: {
		image: "props/interactive-props.png",
		id: "normal",
		rect: [128,182,191,218],
		duration: 200,
	},
},
}
